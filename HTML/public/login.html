<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>登入</title>
  <meta name="description" content="Free Web tutorials" />
  <meta name="keywords" content="HTML, CSS, JavaScript" />
  <meta name="author" content="Liu" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous" />
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
    crossorigin="anonymous"></script>
  <!-- 網頁標題icon -->
  <link rel="icon" href="./航空img/unicon.png" type="image/x-icon" />
  <link rel="shortcut icon" href="./航空img/unicon.png" type="image/x-icon" />
  <!-- 安插jquery -->
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript">

  </script>


  
  <!-- 安插登入按鈕的css -->
  <link rel="stylesheet" href="./個樣式css資料/登入按鈕.css">
<style>.login-background {
  background-image: url(./您的背景圖片路徑.jpg);
  background-size: cover;
  background-position: center;
}
</style>

</head>

<body>
  ---------------------------------------------------------------
    <!-- 移動式標題列 -->
    <nav class="navbar navbar-expand-lg bg-light fixed-top ">
      <!-- 飛機logo首頁 -->
      <div class="d-flex jutisfy-content-start"> <a href="./index.html">
              <img src="./img/logo-evaair-header.png" alt="長榮logo" class="img-fluid w-75">
          </a>
      </div>

      <!-- 下拉式標題 -->
      <div class="container-fluid">

          <ul class="navbar-nav me-auto mb-2 mb-lg-0 d-flex justify-content-between  w-50">
              <li class="nav-item dropdown ">
                  <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown"
                      aria-expanded="false">
                      企業商務旅行
                  </a>
                  <ul class="dropdown-menu">
                      <li><a class="dropdown-item" href="#">主題活動</a></li>
                      <li><a class="dropdown-item" href="#">熱門活動</a></li>
                      <li>
                          <hr class="dropdown-divider">
                      </li>
                      <li><a class="dropdown-item" href="#">限時促銷</a></li>
                  </ul>
              <li class="nav-item dropdown">
                  <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown"
                      aria-expanded="false">
                      機票與訂位管理
                  </a>
                  <ul class="dropdown-menu">
                      <li><a class="dropdown-item" href="#">登入</a></li>
                      <li><a class="dropdown-item" href="#">訂位</a></li>
                      <li>
                          <hr class="dropdown-divider">
                      </li>
                      <li>
                          <a class="dropdown-item" href="#">取消全部行程</a>
                      </li>
                  </ul>
              <li class="nav-item dropdown">
                  <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown"
                      aria-expanded="false">
                      行程管理
                  </a>
                  <ul class="dropdown-menu">
                      <li><a class="dropdown-item" href="#">機票定位</a></li>
                      <li><a class="dropdown-item" href="#">管理行程</a></li>
                      <li>
                          <hr class="dropdown-divider">
                      </li>
                      <li><a class="dropdown-item" href="#">其他</a></li>
                  </ul>
              <li class="nav-item dropdown">
                  <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown"
                      aria-expanded="false">
                      無限萬里遊
                  </a>
                  <ul class="dropdown-menu">
                      <li><a class="dropdown-item" href="#">航班到離查詢</a></li>
                      <li><a class="dropdown-item" href="#">機場服務</a></li>
                      <li>
                          <hr class="dropdown-divider">
                      </li>
                      <li><a class="dropdown-item" href="#">特別需求與協助</a></li>
                  </ul>
          </ul>


    <!-- 登入及註冊 -->
    <nav id="loginop" style="margin-left: 560px; margin-bottom: 40px;  ">
      <div class="user-menu">
        <!-- 使用者名稱與下拉箭頭 -->
        <div id="user-info" class="btn">
          <span id="username"  >使用者名稱</span>
          <span id="arrow">&#9660;</span>
        </div>
        <!-- 下拉式選單 -->
        <div id="dropdown-content">
          <a href="#" id="profile-link">會員頁面</a>
          <a href="#" id="logout-link">登出</a>
        </div>
      </div>
    </nav>

    <!-- 登入及註冊 -->
    <div class="ms-auto">
      <a href="./login.html" id="toLogin" class="btn">登入</a>
      <span>|</span>
      <a href="./regis.html" class="btn">註冊</a>
    </div>
</nav>



      <!-- 登入畫面 -->
      <div class="container my-5 border">
        <!-- 登入畫面的背景移至 CSS 檔案中處理 -->
        <div class="text-center">
          <header><h1 class="display-4"><b>登入</b></h1></header>
          <p class="fs-4">
            歡迎以會員身分登入，或是使用E-mail登入享受便捷服務。
          </p>
        </div>
        
        <!-- 登入表單 -->
        <div class="row justify-content-center">
          <div class="col-md-6">
            <form>
              <div class="mb-3">
                <label for="account_0" class="form-label">帳號 *</label>
                <input type="text" class="form-control" id="account_0" placeholder="請輸入您的帳號">
              </div>
              <div class="mb-3">
                <label for="password_0" class="form-label">密碼 *</label>
                <input type="password" class="form-control" id="password_0" placeholder="請輸入您的密碼">
              </div>
              <div class="mb-3 form-check">
                <input type="checkbox" class="form-check-input" id="check_ok">
                <label class="form-check-label" for="check_ok">記住我的登入方式與帳號 (公用電腦建議不勾選)</label>
              </div>
              <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                <button type="submit" class="btn btn-success me-md-2"  id="login" >登入</button>
                <button type="button" class="btn btn-outline-secondary"id="cancel" >取消</button>
              </div>
            </form>
            <div class="mt-4">
              <a href="./regis.html" class="link-primary">還沒有帳號？前往註冊</a><br>
              <a href="./regis.html" class="link-primary">密碼查詢</a> |
              <a href="./regis.html" class="link-primary">申請密碼</a>
            </div>
          </div>
        </div>
      </div>
      
      


   

        <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>




      <script>


        // 登入後儲存資料在當地位置以後好撈資料
        function handleLoginSuccess(user) {
          localStorage.setItem("currentUser", JSON.stringify(user))

        }

        $("#login").on("click", function () {
          var username = $("#account_0").val();
          var password = $("#password_0").val();


          // .done成功後傳回數值
          $.get("/login", { username: username, password: password })
            .done(function (data) {
              if (data.success) {
                console.log("Login successful", data.user);
                handleLoginSuccess(data.user);
                window.location.href = "/";
              } else {
                alert("無此帳號或密碼", data);
              }
            })
        });


        $("#cancel").on("click", function () {
          window.location.href = "./index.html";
        });
        //檢查是否登入 並給予名字(其他頁面需要)
        var currentUser = JSON.parse(localStorage.getItem("currentUser"));
        if (currentUser) {
          // 用户已登入，顯示用户名
          var genderTtitle = currentUser.gender === "男" ? "先生" : "女士";
          var userLoginName = currentUser.userchfname + genderTtitle;
          $("#toLogin").css("visibility", "hidden")
          $("#loginop").css("visibility", "visible")
          $("#username").text(userLoginName)
        } else {
          // 用户未登入
          console.log("未登入狀態");
          $("#toLogin").css("visibility", "visible"); // 顯示登入按钮
          $("#loginop").css("visibility", "hidden");
        }


      </script>
      <!-- 這是登入切換得js -->
      <script>


        document.addEventListener("DOMContentLoaded", function () {
          // 獲取頁面元素
          var userInfo = document.getElementById("user-info");
          var dropdownContent = document.getElementById("dropdown-content");
          var profileLink = document.getElementById("profile-link");
          var logoutLink = document.getElementById("logout-link");

          // 假設用户已登入，設置用户名
          var username = localStorage.getItem("username");

          if (username) {
            document.getElementById("username").innerText = username;
          }

          // 用户信息點擊事件，顯示/隱藏下拉菜單
          userInfo.addEventListener("click", function () {
            dropdownContent.style.display = dropdownContent.style.display === "block" ? "none" : "block";
          });

          // 會員頁面連結點擊事件
          profileLink.addEventListener("click", function () {
            // 如果用户已登入，重定向到會員頁面

            window.location.href = "./membership.html";

          });

          // 登出連結點擊事件
          logoutLink.addEventListener("click", function () {
            // 清除登入狀態和用户名
            localStorage.removeItem("currentUser");

            // 重定向到登入页面
            window.location.href = "./login.html";
          });
        });
      </script>
      <!-- 返回頂部按鈕 -->
<a href="#top" target="" style="cursor: pointer;">
  <figure id="smart" class="position-fixed bottom-0 end-0">
      <img src="./img/bot.gif" style="object-fit: contain; height: 70px; width:70px; z-index: 1;"> 
  <figcaption style="font-size:17px; text-align: center;">至頂</figcaption>
  </figure>
</a>
<script type="text/javascript" src="./js資料庫/向上移動.js"></script>
</body>

</html>
