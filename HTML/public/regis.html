<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>註冊</title>
  <meta name="description" content="Free Web tutorials" />
  <meta name="keywords" content="HTML, CSS, JavaScript" />
  <meta name="author" content="Liu" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous" />
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
    crossorigin="anonymous"></script>
  <!-- 網頁標題icon -->
  <link rel="icon" href="./長榮航空img/長榮小icon.png" type="image/x-icon" />
  <link rel="shortcut icon" href="./長榮航空img/長榮小icon.png" type="image/x-icon" />
  <!-- 測試用 找框架 -->
  
   <!-- 安插登入按鈕的css -->
   <link rel="stylesheet" href="./個樣式css資料/登入按鈕.css">

  <style>
    .pic {
      border: 1px black solid;
      width: 450;
      height: 300;
    }

    /* 置中框架 */
    .center {
      text-align: center;
    }
  </style>

  <!-- 安插jquery -->
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript">
    // 程式放在這裏
    // $(document).ready(function(){
    //     $("#btn-plus1").click(function(){
    //         $("#adult_quantity").innerHTML++;
    //     })
    // })
  </script>
 
</head>

<body>
     <!-- 移動式標題列 -->
     <nav class="navbar navbar-expand-lg bg-light fixed-top ">
      <!-- 飛機logo首頁 -->
      <div class="d-flex jutisfy-content-start"> <a href="./index.html">
              <img src="./img/logo-evaair-header.png" alt="長榮logo" class="img-fluid w-75">
          </a>
      </div>

      <!-- 下拉式標題 -->
      <div class="container-fluid">

          <ul class="navbar-nav me-auto mb-2 mb-lg-0 d-flex justify-content-between  w-50">
              <li class="nav-item dropdown ">
                  <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown"
                      aria-expanded="false">
                      企業商務旅行
                  </a>
                  <ul class="dropdown-menu">
                      <li><a class="dropdown-item" href="#">主題活動</a></li>
                      <li><a class="dropdown-item" href="#">熱門活動</a></li>
                      <li>
                          <hr class="dropdown-divider">
                      </li>
                      <li><a class="dropdown-item" href="#">限時促銷</a></li>
                  </ul>
              <li class="nav-item dropdown">
                  <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown"
                      aria-expanded="false">
                      機票與訂位管理
                  </a>
                  <ul class="dropdown-menu">
                      <li><a class="dropdown-item" href="#">登入</a></li>
                      <li><a class="dropdown-item" href="#">訂位</a></li>
                      <li>
                          <hr class="dropdown-divider">
                      </li>
                      <li>
                          <a class="dropdown-item" href="#">取消全部行程</a>
                      </li>
                  </ul>
              <li class="nav-item dropdown">
                  <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown"
                      aria-expanded="false">
                      行程管理
                  </a>
                  <ul class="dropdown-menu">
                      <li><a class="dropdown-item" href="#">機票定位</a></li>
                      <li><a class="dropdown-item" href="#">管理行程</a></li>
                      <li>
                          <hr class="dropdown-divider">
                      </li>
                      <li><a class="dropdown-item" href="#">其他</a></li>
                  </ul>
              <li class="nav-item dropdown">
                  <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown"
                      aria-expanded="false">
                      無限萬里遊
                  </a>
                  <ul class="dropdown-menu">
                      <li><a class="dropdown-item" href="#">航班到離查詢</a></li>
                      <li><a class="dropdown-item" href="#">機場服務</a></li>
                      <li>
                          <hr class="dropdown-divider">
                      </li>
                      <li><a class="dropdown-item" href="#">特別需求與協助</a></li>
                  </ul>
          </ul>

    <!-- 登入及註冊 -->
    <nav id="loginop" style="margin-left: 560px; margin-bottom: 40px;  ">
      <div class="user-menu">
        <!-- 使用者名稱與下拉箭頭 -->
        <div id="user-info" class="btn">
          <span id="username"  >使用者名稱</span>
          <span id="arrow">&#9660;</span>
        </div>
        <!-- 下拉式選單 -->
        <div id="dropdown-content">
          <a href="#" id="profile-link">會員頁面</a>
          <a href="#" id="logout-link">登出</a>
        </div>
      </div>
    </nav>

    <!-- 登入及註冊 -->
    <div class="ms-auto">
      <a href="./login.html" id="toLogin" class="btn">登入</a>
      <span>|</span>
      <a href="./regis.html" class="btn">註冊</a>
    </div>
</nav>


      <!-- 註冊畫面 -->
      <div class="container py-5  mt-5">
        <div class="row">
            <div class="col-md-8 offset-md-2">
                <div class="bg-light p-5 rounded">
                    <h1 class="text-center mb-4">註冊</h1>
                    <div class="text-center mb-4">
                        <img src="./長榮航空img/infinity-logo.png "  class="img-fluid " style="height: 250px; width: 300px;"   alt="Infinity Logo" />
                    </div>
                    <p class="lead text-center">歡迎您註冊成為會員</p>
                    <form>
                        <div class="mb-3">
                            <label for="email_0" class="form-label">E-Mail帳號 *</label>
                            <input type="email" class="form-control" id="email_0" placeholder="請輸入您的電子郵件">
                        </div>
                        <div class="mb-3">
                            <label for="password_1" class="form-label">設定密碼 *</label>
                            <input type="password" class="form-control" id="password_1" placeholder="請設定密碼">
                        </div>
                        <div class="mb-3">
                            <label for="password_2" class="form-label">確認密碼 *</label>
                            <input type="password" class="form-control" id="password_2" placeholder="再次輸入密碼">
                        </div>
                        <h2 class="h4 mb-3">個人資料</h2>
                        <div class="mb-3">
                            <label for="en-fname" class="form-label">英文姓名(與護照一致) *</label>
                            <input type="text" class="form-control" id="en-fname" placeholder="姓氏">
                        </div>
                        <div class="mb-3">
                            <label for="en_name" class="form-label">英文名+中間名 (與護照一致) *</label>
                            <input type="text" class="form-control" id="en_name" placeholder="名字+中間名">
                        </div>
                        <div class="mb-3">
                            <label for="ch_fname" class="form-label">中文姓*</label>
                            <input type="text" class="form-control" id="ch_fname" placeholder="中文姓">
                        </div>
                        <div class="mb-3">
                            <label for="ch_name" class="form-label">中文名*</label>
                            <input type="text" class="form-control" id="ch_name" placeholder="中文名">
                        </div>
                        <div class="mb-3">
                          <label class="form-label">性別*</label><br>
                          <div class="form-check form-check-inline">
                            <input type="radio" name="sex" value="男" class="form-check-input" id="male">
                            <label for="male" class="form-check-label">男性</label>
                          </div>
                          <div class="form-check form-check-inline">
                            <input type="radio" name="sex" value="女" class="form-check-input" id="fmale">
                            <label for="fmale" class="form-check-label">女性</label>
                          </div>
                        </div>
                        <div class="mb-3">
                          <label class="form-label">生日*</label><br>
                          <div class="d-flex justify-content-start">
                            <select name="" id="year" class="form-select me-1" style="width: auto;">
                              <!-- 年份選項 -->
                            </select>
                            <select name="" id="month" class="form-select me-1" style="width: auto;">
                              <!-- 月份選項 -->
                            </select>        
                            <select name="" id="day" class="form-select" style="width: auto;">
                              <!-- 日選項 -->
                            </select>
                          </div>
                        </div>
                        
                      <div class="mb-3">
                        <h3>手機號碼</h3>
                        <label for="phone_number" class="form-label">手機號碼 *</label>
                        <input type="text" class="form-control" id="phone_number" placeholder="09********">
                    </div>                
                    <div class="d-grid gap-2">
                      <button type="submit" class="btn btn-success" id="regi_btn">註冊</button>
                  </div>
              </form>
          </div>
      </div>
  </div>
</div>




      <!-- 寫入 生日 年月日選項 -->
      <script>
        var currentYear = new Date().getFullYear();
        var currentMonth = new Date().getMonth();
        var currentMonth = new Date().getMonth();
        for (i = 1900; i <= currentYear; i++) {
          var k = document.createElement("option");
          k.value = i;
          k.text = i;
          document.getElementById("year").appendChild(k);
        }
        for (j = 1; j <= 12; j++) {
          var x = document.createElement("option");
          x.value = j;
          x.text = j;
          document.getElementById("month").appendChild(x);
        }
        for (j = 1; j <= 31; j++) {
          var y = document.createElement("option");
          y.value = j;
          y.text = j;
          document.getElementById("day").appendChild(y);
        }





        // GPT生成
        function isValidEmail(email) {
          const emailRegex = /^[A-Za-z0-9._%-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/;
          return emailRegex.test(email);
        }

        function validateEmail() {
          const email = document.getElementById("email_0").value;
          if (isValidEmail(email)) {
            document.getElementById("error-message").textContent = "email格式有效";
          } else {
            document.getElementById("error-message").textContent = "email格式無效";
          }
        }
        // 在输入框失去焦点时进行验证
        document.getElementById("email_0").addEventListener("blur", validateEmail);



        // 這裡寫註冊傳送資料
        $(document).ready(function () {
          $("#regi_btn").on("click", function (event) {
            event.preventDefault(); // 阻止表单默认提交行为

            $.post("/registe/post", function (e) {


              // 男女判別
              var genderValue = $("input[name='sex']:checked").val();
              // 收集表单数据

              var userData = {
                userfirstname: $("#en-fname").val(),
                userlastname: $("#en_name").val(),
                userchfname: $("#ch_fname").val(),
                userchname: $("#ch_name").val(),
                gender: genderValue,
                password: $("#password_1").val(),
                email: $("#email_0").val(),
                birth: $("#year").val() + $("#month").val() + $("#day").val(),
                phone: $("#phone_number").val(),
              };

              // 用ajax 發送
              $.ajax({
                type: "POST",
                url: "/registe/post",
                data: JSON.stringify(userData), //轉換JSON字符串
                contentType: "application/json",
                success: function (response) {
                  // 成功給訊息
                  alert("註冊成功");
                  var redirectTo = "/"
                  window.location.href = redirectTo;
                },
                error: function (error) {
                  // 錯誤給訊息
                  alert("訂單創建失敗：" + error);
                }
              });
            });
          })

        })




      </script>


      <script>




        $("#cancel").on("click", function () {
          window.location.href = "./index.html";
        });

        //檢查是否登入 並給予名字(其他頁面需要)
        var currentUser = JSON.parse(localStorage.getItem("currentUser"));
        if (currentUser) {
          // 用户已登录，显示用户名
          var genderTtitle = currentUser.gender === "男" ? "先生" : "女士";
          var userLoginName = currentUser.userchfname + genderTtitle;
          $("#toLogin").css("visibility", "hidden")
          $("#loginop").css("visibility", "visible")
          $("#username").text(userLoginName)
        } else {
          // 用户未登录
          console.log("未登入狀態");
          $("#toLogin").css("visibility", "visible"); // 显示登录按钮
          $("#loginop").css("visibility", "hidden");
        }



      </script>
      <!-- 這是登入切換得js -->
      <script>
        document.addEventListener("DOMContentLoaded", function () {
          // 获取页面元素
          var userInfo = document.getElementById("user-info");
          var dropdownContent = document.getElementById("dropdown-content");
          var profileLink = document.getElementById("profile-link");
          var logoutLink = document.getElementById("logout-link");

          // 假设用户已登录，设置用户名
          var username = localStorage.getItem("username");

          if (username) {
            document.getElementById("username").innerText = username;
          }

          // 用户信息点击事件，显示/隐藏下拉菜单
          userInfo.addEventListener("click", function () {
            dropdownContent.style.display = dropdownContent.style.display === "block" ? "none" : "block";
          });

          // 会员页面链接点击事件
          profileLink.addEventListener("click", function () {
            // 如果用户已登录，重定向到会员页面

            window.location.href = "./membership.html";

          });

          // 登出链接点击事件
          logoutLink.addEventListener("click", function () {
            // 清除登录状态和用户名
            localStorage.removeItem("currentUser");

            // 重定向到登录页面
            window.location.href = "./login.html";
          });
        });
      </script>
      <!-- 返回頂部按鈕 -->
<a href="#top" target="" style="cursor: pointer;">
  <figure id="smart" class="position-fixed bottom-0 end-0">
      <img src="./img/bot.gif" style="object-fit: contain; height: 70px; width:70px; z-index: 1;"> 
  <figcaption style="font-size:17px; text-align: center;"></figcaption>
  </figure>
</a>
<script type="text/javascript" src="./js資料庫/向上移動.js"></script>
</body>

</html>